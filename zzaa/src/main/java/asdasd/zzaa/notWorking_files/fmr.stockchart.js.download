function BarsDataSource(){DataSource.call(this,"Bars"),this._data=void 0}function VolumeDataSource(t){DataSeriesDataSource.call(this,"Volume","Volume"),this._barsDataSource=t,EventBus.on(t,"DataSource:datachanged",this.onDataSourceDataChanged,this)}function OpenPriceDataSource(t){DataSeriesDataSource.call(this,"Open","Open"),this._barsDataSource=t,EventBus.on(t,"DataSource:datachanged",this.onDataSourceDataChanged,this)}function HighPriceDataSource(t){DataSeriesDataSource.call(this,"High","High"),this._barsDataSource=t,EventBus.on(t,"DataSource:datachanged",this.onDataSourceDataChanged,this)}function LowPriceDataSource(t){DataSeriesDataSource.call(this,"Low","Low"),this._barsDataSource=t,EventBus.on(t,"DataSource:datachanged",this.onDataSourceDataChanged,this)}function ClosePriceDataSource(t){DataSeriesDataSource.call(this,"Close","Close"),this._barsDataSource=t,EventBus.on(t,"DataSource:datachanged",this.onDataSourceDataChanged,this)}function BarsAxisMinMaxSource(t,e){AxisMinMaxSource.call(this,t),this._xAxis=e,this.setPriority(-1),this._chartType=Fmr_StockChart_ChartType.OHLC,EventBus.on(this._xAxis,"Axis:scalechanged",this.onAxisScaleChanged,this)}function PreviousCloseAxisMinMaxSource(t){AxisMinMaxSource.call(this,t)}function OHLCSeries(t,e){if(!t)throw new UndefinedOrNullException("bars");if(!e)throw new UndefinedOrNullException("chart");PlotObject.call(this),this._bars=t,this._chart=e,this.setZIndex(50)}function VolumeSeries(t,e){if(!t)throw new UndefinedOrNullException("barsDataSource");if(!e)throw new UndefinedOrNullException("chart");this._barsDataSource=t,this._chart=e,this.setOpacity(1),EventBus.on(t,"DataSource:datachanged",this.update,this)}function StockLineSeries(t,e){if(!t)throw new UndefinedOrNullException("bars");if(!e)throw new UndefinedOrNullException("chart");this._bars=t,this._chart=e,this._lineWidth=1,this.setZIndex(50)}function StackedPlotObject(t,e){if(PlotObject.call(this),void 0===t||null===t)throw new UndefinedOrNullException("data");if(void 0===e||null===e)throw new UndefinedOrNullException("x");this._data=t,this._x=e}function CorporateActionPlotObject(t,e){if(!(t instanceof Array)||t.length<=0)throw new ArgumentException("data","the parameter data should be a non-empty array");StackedPlotObject.call(this,t,e)}function DigitalVolatilityPlotObject(t,e){if(!(t instanceof Array)||t.length<=0)throw new ArgumentException("data","the parameter data should be a non-empty array");StackedPlotObject.call(this,t,e)}function StackedPlotObjectSeries(){PlotObject.call(this),this._plotObjects=[],this._dataSeries=null,this.setZIndex(60)}function IndicatorLabel(t,e,a,i){HeaderLabel.call(this,t),this.label=e,this._trackballDataSource=a,this._seriesDataSource=i,this.showLastValue=!0,a&&i&&(this.update(),EventBus.on(a,"DataSource:datachanged",this.update,this),EventBus.on(i,"DataSource:datachanged",this.update,this))}function PriceIndicator(t,e,a){HeaderLabel.call(this,t),this._barsDataSource=a,this._trackballDataSource=e,this.timestamp=void 0,this.open=0,this.close=0,this.high=0,this.low=0,this.isIntraday=!1,EventBus.on(e,"DataSource:datachanged",this.update,this),EventBus.on(a,"DataSource:datachanged",this.update,this)}function StockChart(t){Chart.call(this),t&&(this._horizontalGridLineColor=t.horizontalGridLineColor,this._verticalGridLineColor=t.verticalGridLineColor,this._mountainColor=t.mountainColor,this._mountainLineColor=t.mountainLineColor,this._mountainFilledWithFixedColor=t.mountainFilledWithFixedColor)}function CandlestickSeries(t,e){if(!t)throw new UndefinedOrNullException("bars");if(!e)throw new UndefinedOrNullException("chart");PlotObject.call(this),this._bars=t,this._chart=e,this.setZIndex(50)}function FilledCandlestickSeries(t,e){CandlestickSeries.call(this,t,e)}function StandardCandlestickSeries(t,e){CandlestickSeries.call(this,t,e)}function HollowCandlestickSeries(t,e){CandlestickSeries.call(this,t,e)}function ExtendedHourDatasource(t,e){DataSource.call(this,"ExtendedHourRanges"),this._xAxis=t,this._extendedHourFlagDatasource=e,this.getRanges()}function ExtendedHourShading(t,e){PlotObject.call(this),this._extendedHourDatasource=t,this._showExtendedHour=e,this.setZIndex(2),this.setOpacity(.4),this.setColor(ObjectFactory.createInstance(tinycolor,"#CCC")),EventBus.on(t,"DataSource:datachanged",this.update,this),EventBus.on(e,"DataSource:datachanged",this.update,this)}function StackedPlotObjectSeriesAxisMinMaxSource(t,e,a){AxisMinMaxSource.call(this,ObjectFactory.createInstance(SingleValueDataSource,t)),this._stackedPlotObjectSeries=t,this._xAxis=e,this._yAxis=a,this._eventRegistered=!1,this.setPriority(910)}function SynchronizedClosePriceDataSource(t,e,a,i){DataSeriesDataSource.call(this,t,e),this._barsDataSource=a,this._baseBarsDataSource=i,this.barsUpdated(),EventBus.on(a,"DataSource:datachanged",this.barsUpdated,this),EventBus.on(i,"DataSource:datachanged",this.barsUpdated,this)}var stockChartModule=angular.module("fmr.stockchart",["fmr.pwi.commons","fmr.pwi.charting"]),BarsExtensions=function(){var t={},e=function(t){if(!t)throw new UndefinedOrNullException("bars")},a=function(t,e){if(void 0===t||null===t)throw new UndefinedOrNullException("index");if(t<0||t>=e)throw new ArgumentOutOfRangeException("index")},i=function(t){if(void 0===t||null===t)throw new UndefinedOrNullException("type")},r=function(t){if(void 0===t||null===t)throw new UndefinedOrNullException("scale")};return t.getBarTrend=function(r,s,n){return e(r),a(s,r.length),i(n),n===Fmr_StockChart_ChartType.OHLC?t.getBarTrendForOHLC(r,s):t.getBarTrendForNonOHLC(r,s)},t.getBarTrendForOHLC=function(t,i){e(t),a(i,t.length);var r=t[i],s=r.close,n=r.open;if(0===i)return s>=n?Fmr_Pwi_Charting_BarTrend.UP:Fmr_Pwi_Charting_BarTrend.DOWN;var o=t[i-1].close;return o>s?Fmr_Pwi_Charting_BarTrend.DOWN:Fmr_Pwi_Charting_BarTrend.UP},t.getBarTrendForNonOHLC=function(t,i){e(t),a(i,t.length);var r=t[i],s=r.close,n=r.open;if(0===i)return s>=n?Fmr_Pwi_Charting_BarTrend.UP:Fmr_Pwi_Charting_BarTrend.DOWN;if(s>n)return Fmr_Pwi_Charting_BarTrend.UP;if(s===n){var o=t[i-1].close;return o>s?Fmr_Pwi_Charting_BarTrend.DOWN:Fmr_Pwi_Charting_BarTrend.UP}return Fmr_Pwi_Charting_BarTrend.DOWN},t.previousClose=function(t,a,i){e(t),r(a),i=i||ObjectFactory.createInstance(MarketInfo);var s=t.length;if(!(s<=0)){if(!a.isIntraday())return s>=2?t[s-2].close:void 0;for(var n=t[s-1].timestamp,o=i.marketOpen(n,!1),c=s-2;c>=0;c--)if(t[c].timestamp.getTime()<o.getTime())return t[c].close}},t.deduceMarketOpen=function(t){e(t);var a=ObjectFactory.createInstance(MarketInfo),i=t.length;if(i)for(var r=t[i-1].timestamp,s=new Date(r.getFullYear(),r.getMonth(),r.getDate()-1,20,0,0),n=0;n<i;n++)if(s<t[n].timestamp){var o=a.marketOpen(t[n].timestamp,!1);if(o.getTime()===t[n].timestamp.getTime())return o;var c=new Date(t[n].timestamp.getFullYear(),t[n].timestamp.getMonth(),t[n].timestamp.getDate(),t[n].timestamp.getHours(),0,0);return c}},t}();BarsDataSource.prototype=function(){function t(){return this._data?this._data.bars:void 0}function e(t){var e=this._data,a=e?e.bars:void 0;this._data=null===t?void 0:t;var i=t?t.bars:void 0;(a||i)&&a!==i&&EventBus.trigger(this,"DataSource:datachanged",{oldBars:a,newBars:i})}function a(){return this._data}function i(){return this._data?this._data.getScale():void 0}function r(){return this._data?this._data.getMarketInfo():void 0}function s(){return this._data?this._data.getSymbol():""}var n=Object.create(DataSource.prototype);return n.getSecurityData=a,n.getBars=t,n.setBars=e,n.getSymbol=s,n.getScale=i,n.getMarketInfo=r,n}(),BarsDataSource.prototype.constructor=BarsDataSource,VolumeDataSource.prototype=function(){function t(t,e){var a=e.newBars||ObjectFactory.createInstance(Bars);this._dataseries=a.getVolumeSeries(),EventBus.trigger(this,"DataSource:datachanged")}function e(){EventBus.off(this._barsDataSource,"DataSource:datachanged",this.onDataSourceDataChanged,this)}var a=Object.create(DataSeriesDataSource.prototype);return a.onDataSourceDataChanged=t,a.destroy=e,a}(),VolumeDataSource.prototype.constructor=VolumeDataSource,OpenPriceDataSource.prototype=function(){function t(){var t=this._barsDataSource.getBars()||ObjectFactory.createInstance(Bars);this._dataseries=t.getOpenSeries(),EventBus.trigger(this,"DataSource:datachanged")}function e(){EventBus.off(this._barsDataSource,"DataSource:datachanged",this.onDataSourceDataChanged,this)}var a=Object.create(DataSeriesDataSource.prototype);return a.onDataSourceDataChanged=t,a.destroy=e,a}(),OpenPriceDataSource.prototype.constructor=OpenPriceDataSource,HighPriceDataSource.prototype=function(){function t(){var t=this._barsDataSource.getBars()||ObjectFactory.createInstance(Bars);this._dataseries=t.getHighSeries(),EventBus.trigger(this,"DataSource:datachanged")}function e(){EventBus.off(this._barsDataSource,"DataSource:datachanged",this.onDataSourceDataChanged,this)}var a=Object.create(DataSeriesDataSource.prototype);return a.onDataSourceDataChanged=t,a.destroy=e,a}(),HighPriceDataSource.prototype.constructor=HighPriceDataSource,LowPriceDataSource.prototype=function(){function t(){var t=this._barsDataSource.getBars()||ObjectFactory.createInstance(Bars);this._dataseries=t.getLowSeries(),EventBus.trigger(this,"DataSource:datachanged")}function e(){EventBus.off(this._barsDataSource,"DataSource:datachanged",this.onDataSourceDataChanged,this)}var a=Object.create(DataSeriesDataSource.prototype);return a.onDataSourceDataChanged=t,a.destroy=e,a}(),LowPriceDataSource.prototype.constructor=LowPriceDataSource,ClosePriceDataSource.prototype=function(){function t(){var t=this._barsDataSource.getBars()||ObjectFactory.createInstance(Bars);this._dataseries=t.getCloseSeries(),EventBus.trigger(this,"DataSource:datachanged")}function e(){EventBus.off(this._barsDataSource,"DataSource:datachanged",this.onDataSourceDataChanged,this)}var a=Object.create(DataSeriesDataSource.prototype);return a.onDataSourceDataChanged=t,a.destroy=e,a}(),ClosePriceDataSource.prototype.constructor=ClosePriceDataSource;var Fmr_StockChart_ChartType={OHLC:0,HollowCandlestick:1,FilledCandlestick:2,StandardCandlestick:3,Line:4,Mountain:5};BarsAxisMinMaxSource.prototype=function(){function t(t,e,a){for(var i,r,s=!1,n=t.length-1;n>=0;n--)if(this._xAxis.isVisible(t[n].timestamp))s?(i>t[n][e]&&(i=t[n][e]),r<t[n][a]&&(r=t[n][a])):(i=t[n][e],r=t[n][a],s=!0);else if(t[n].timestamp<this._xAxis.getMinValue())break;return s?new Range(i,r):void 0}function e(t){return t===Fmr_StockChart_ChartType.Line||t===Fmr_StockChart_ChartType.Mountain}function a(){var t=this._dataSource.getScale(),e=this._xAxis.getScale();t&&e&&e.equals(t)&&EventBus.trigger(this,"AxisMinMaxSource:minmaxchanged")}function i(t){var a=this._chartType;this._chartType=t,e(a)!==e(t)&&EventBus.trigger(this,"AxisMinMaxSource:minmaxchanged")}function r(){var e=this._dataSource.getBars();if(e&&!(e.length<=0)){var a;return a=this._chartType===Fmr_StockChart_ChartType.Line||this._chartType===Fmr_StockChart_ChartType.Mountain?t.call(this,e,"close","close"):t.call(this,e,"low","high")}}function s(){AxisMinMaxSource.prototype.destroy.call(this),EventBus.off(this._xAxis,"Axis:scalechanged",this.onAxisScaleChanged,this)}var n=Object.create(AxisMinMaxSource.prototype);return n.setChartType=i,n.getMinMax=r,n.destroy=s,n.onAxisScaleChanged=a,n}(),BarsAxisMinMaxSource.prototype.constructor=BarsAxisMinMaxSource,PreviousCloseAxisMinMaxSource.prototype=function(){function t(){var t=this._dataSource.getBars();if(t&&!(t.length<=0)){var e=this._dataSource.getScale(),a=this._dataSource.getMarketInfo(),i=BarsExtensions.previousClose(t,e,a);return void 0!==i&&null!==i?ObjectFactory.createInstance(Range,i,i):void 0}}var e=Object.create(AxisMinMaxSource.prototype);return e.getMinMax=t,e}(),PreviousCloseAxisMinMaxSource.prototype.constructor=PreviousCloseAxisMinMaxSource,OHLCSeries.prototype=function(){function t(t,e,a,i,r){var s=[];if(t.y===e.y&&e.y===a.y&&a.y===i.y)return s.push(["M",t.x,t.y]),s.push(["L",i.x,i.y]),s;var n=r>1;return s.push(["M",e.x,e.y]),s.push(["L",a.x,a.y]),n&&(t.y===i.y?(s.push(["M",t.x,t.y]),s.push(["L",i.x,i.y])):(s.push(["M",t.x,t.y]),s.push(["L",e.x,t.y]),s.push(["M",i.x,i.y]),s.push(["L",a.x,i.y]))),s}function e(t){var e=t/2-1;return e<1?1:e>8?8:e}function a(t,e,a,i){var r=ObjectFactory.createInstance(fabric.Path,t,{stroke:e.toRgbString(),strokeWidth:1,left:0,top:0,width:a,height:i});return r.left=0,r.top=0,r}function i(t,e){for(var a=e.length-1;a>=0;a--)t.unshift(e[a])}function r(){return ObjectFactory.createInstance(fabric.PathGroup,[])}function s(){for(var r=[],s=[],n=this._pane.getXAxis(),o=this._pane.getYAxis(),c=n.getBarWidth(),h=e(c),l=n.getLength(),u=o.getLength(),d=this._bars,_=d.length,g=_-1;g>=0;g--){var p=d[g],f=n.toCoordinate(p.timestamp);if(!(f>=l)){if(f<=0)break;var S=Math.floor(f)+.5,x=o.toCoordinate(p.open),b=o.toCoordinate(p.high),v=o.toCoordinate(p.low),y=o.toCoordinate(p.close),m=new Point(S-h,x),D=new Point(S,b),C=new Point(S,v),O=new Point(S+h,y),P=t(m,D,C,O,c),k=BarsExtensions.getBarTrend(d,g,Fmr_StockChart_ChartType.OHLC),j=r;k!==Fmr_Pwi_Charting_BarTrend.UP&&(j=s),i(j,P)}}this._element.paths=[a(r,this._chart.getUpColor(),l,u),a(s,this._chart.getDownColor(),l,u)]}var n=Object.create(PlotObject.prototype);return n.createElement=r,n.updateElement=s,n}(),OHLCSeries.prototype.constructor=OHLCSeries,VolumeSeries.prototype=function(){function t(t,e){var a=this._chart.getUpColor(),i=this._chart.getDownColor();return BarsExtensions.getBarTrendForOHLC(t,e)===Fmr_Pwi_Charting_BarTrend.UP?a:i}function e(e){var a=this._pane,i=this._barsDataSource.getBars();if(i&&!(i.length<=0))for(var r=a.getXAxis(),s=this.getYAxis(),n=s.toCoordinate(s.getMinValue()),o=r.getBarWidth()-1,c=o/2,h=r.getLength(),l=i.length-1;l>=0;l--){var u=i[l],d=r.toCoordinate(u.timestamp);if(!(d>=h)){if(d<=0)break;var _=s.toCoordinate(u.volume),g=d-c,p=_,f=n-p,S=t.call(this,i,l),x=Math.floor(g),b=Math.max(Math.floor(g+o)-x,1);g=x;var v=ObjectFactory.createInstance(fabric.Rect,{left:g,top:p,width:b,height:f,opacity:this.getOpacity(),fill:S.toRgbString()});e.add(v)}}}function a(){return ObjectFactory.createInstance(fabric.Group)}function i(){var t=this._element;t.forEachObject(function(e){t.remove(e)}),e.call(this,t)}var r=Object.create(PlotObject.prototype);return r.createElement=a,r.updateElement=i,r}(),VolumeSeries.prototype.constructor=VolumeSeries,StockLineSeries.prototype=function(){function t(t,e,a,i,r){var s=ObjectFactory.createInstance(fabric.Path,t,{stroke:e.toRgbString(),strokeWidth:a,left:0,top:0,width:i,height:r});return s}function e(e,i){var r=e._bars,s=e._chart,n=e._lineWidth,o=s.getUpColor(),c=s.getDownColor(),h=e._pane,l=h.getXAxis(),u=h.getYAxis(),d=l.getLength(),_=u.getLength(),g=[],p=[],f=[];r=a(r,l.getMinValue(),l.getMaxValue());var S=r.length;if(!(S<=0)){var x=l.toCoordinate(r[0].timestamp),b=u.toCoordinate(r[0].close);g.push(ObjectFactory.createInstance(Point,x,b));for(var v=1;v<S;v++){var y=r[v],m=l.toCoordinate(y.timestamp),D=u.toCoordinate(y.close);g.push(ObjectFactory.createInstance(Point,m,D));var C=BarsExtensions.getBarTrendForNonOHLC(r,v);C===Fmr_Pwi_Charting_BarTrend.UP?(p.push(["M",g[v-1].x,g[v-1].y]),p.push(["L",g[v].x,g[v].y])):(f.push(["M",g[v-1].x,g[v-1].y]),f.push(["L",g[v].x,g[v].y]))}i.paths=[t(p,o,n,d,_),t(f,c,n,d,_)]}}function a(t,e,a){var i=commonsModule.$.grep(t,function(t){return t.timestamp>=e&&t.timestamp<=a});return i}function i(){return ObjectFactory.createInstance(fabric.PathGroup,[])}function r(){var t=this._element;e(this,t)}function s(t){if(void 0===t||null===t)throw new UndefinedOrNullException("width");if(isNaN(t)||t<=0)throw new ArgumentOutOfRangeException("width");this._lineWidth=t}function n(){return this._lineWidth}var o=Object.create(PlotObject.prototype);return o.createElement=i,o.updateElement=r,o.setLineWidth=s,o.getLineWidth=n,o}(),StockLineSeries.prototype.constructor=StockLineSeries,StackedPlotObject.prototype=function(){function t(){return this._data}function e(){return this._x}function a(){}var i=Object.create(PlotObject.prototype);return i.getData=t,i.getXValue=e,i.getHeight=a,i}(),StackedPlotObject.prototype.constructor=StackedPlotObject,CorporateActionPlotObject.prototype=function(){function t(){var t=new fabric.Text("",{stroke:"#ffffff",strokeWidth:1,fontFamily:"Helevetica",fontSize:12,originX:"center",originY:"center"}),e=new fabric.Rect({fill:"#cc6828",width:g,height:g,originX:"center",originY:"center"}),a=new fabric.Group([e,t],{left:0,top:0,width:g,height:g});return a}function e(t,e){var a=new fabric.Path(t,{fill:e,width:g,height:g,originX:"center",originY:"center"}),i=new fabric.Group([a],{left:0,top:0,width:g,height:g});return i}function a(){if(!this._element)if(this._data.length>1)this._element=t();else{var a,i,r=this._data[0];if(r.actionType===Fmr_Pwi_Commons_CorporateActionType.Split)a=n,i=o;else if(r.actionType===Fmr_Pwi_Commons_CorporateActionType.Dividend)a=c,i=h;else{var s=r.isDown;a=s?l:d,i=s?u:_}this._element=e(a,i)}return this._element}function i(){this._data.length>1&&this._element.item(1).set({text:this._data.length.toString()})}function r(){return g}function s(t,e){if(this._element){var a=this._element.left,i=this._element.top,r=this._element.width,s=this._element.height;return t>=a&&t<=a+r&&e>=i&&e<=i+s?this:void 0}}var n="m9.92,9.729c-0.123,0.257 -0.294,0.475 -0.515,0.653c-0.242,0.194 -0.524,0.345 -0.846,0.45399c-0.322,0.109 -0.71,0.164 -1.164,0.164c-0.487,0 -0.924,-0.046 -1.313,-0.137c-0.389,-0.09 -0.784,-0.225 -1.186,-0.404l0,-1.125l0.063,0c0.342,0.285 0.736,0.50401 1.184,0.658c0.448,0.154 0.868,0.23199 1.261,0.23199c0.557,0 0.99,-0.104 1.3,-0.313c0.31001,-0.209 0.465,-0.487 0.465,-0.835c0,-0.3 -0.073,-0.52 -0.22,-0.662c-0.147,-0.143 -0.37,-0.253 -0.669,-0.331c-0.22701,-0.061 -0.473,-0.111 -0.737,-0.15c-0.265,-0.03899 -0.545,-0.089 -0.842,-0.14999c-0.599,-0.12701 -1.043,-0.344 -1.331,-0.651c-0.289,-0.307 -0.433,-0.707 -0.433,-1.2c0,-0.56499 0.238,-1.029 0.716,-1.391c0.478,-0.361 1.084,-0.541 1.819,-0.541c0.475,0 0.911,0.045 1.307,0.136c0.396,0.09 0.747,0.202 1.053,0.335l0,1.062l-0.064,0c-0.257,-0.218 -0.595,-0.399 -1.014,-0.542c-0.419,-0.144 -0.848,-0.216 -1.286,-0.216c-0.481,0 -0.867,0.1 -1.159,0.3c-0.292,0.199 -0.438,0.45599 -0.438,0.771c0,0.281 0.07201,0.502 0.218,0.662c0.145,0.16 0.4,0.283 0.767,0.367c0.193,0.043 0.468,0.094 0.825,0.155c0.35699,0.06001 0.659,0.122 0.907,0.186c0.502,0.133 0.88,0.334 1.135,0.603c0.254,0.269 0.381,0.646 0.381,1.13c0,0.263 -0.061,0.52299 -0.184,0.78m-2.42,-9.729c-4.14301,0 -7.5,3.357 -7.5,7.5c0,4.141 3.35699,7.5 7.5,7.5c4.142,0 7.5,-3.359 7.5,-7.5c0,-4.143 -3.358,-7.5 -7.5,-7.5z",o="#0f57c2",c="m7.5,0c-4.143,0 -7.5,3.357 -7.5,7.5c0,4.141 3.357,7.5 7.5,7.5c4.14201,0 7.5,-3.359 7.5,-7.5c0,-4.143 -3.35799,-7.5 -7.5,-7.5zm-2.421,3.946c0.529,-0.07999 1.159,-0.14 1.849,-0.14c1.25,0 2.139,0.29 2.729,0.839c0.6,0.55 0.95,1.32899 0.95,2.419c0,1.099 -0.34,1.999 -0.97,2.618c-0.629,0.63 -1.669,0.97 -2.978,0.97c-0.62,0 -1.14,-0.03 -1.579,-0.08l0,-6.626l-0.001,0zm0.869,5.957c0.21999,0.04 0.53999,0.05 0.88,0.05c1.859,0 2.868,-1.04 2.868,-2.858c0.01,-1.589 -0.89,-2.599 -2.729,-2.599c-0.45,0 -0.79,0.04 -1.02,0.09l0,5.317l0.001,0z",h="#0f57c2",l="m9.82799,2.46418l-3.79497,0l0,1.979l3.79497,0l0,0.853l-3.79497,0l0,2.681l3.79497,0l0,0.853l-4.75497,0l0,-7.219l4.75497,0l0,0.853zm-2.50198,-3.501l-9.52599,0l4.76199,8.25l4.76401,8.25l4.76396,-8.25l4.76206,-8.25l-9.52603,0l-0.00001,0l0.00001,0z",u="#ff0000",d="m10.013811,13.00798l-3.781373,0l0,-1.978988l3.781373,0l0,-0.853004l-3.781373,0l0,-2.681l3.781373,0l0,-0.852998l-4.73793,0l0,7.218995l4.73793,0l0,-0.853005zm-2.492982,3.501003l-9.491838,0l4.744874,-8.249994l4.746964,-8.250013l4.746873,8.250013l4.744925,8.249994l-9.491798,0l0.000001,0z",_="#008000",g=15,p=Object.create(StackedPlotObject.prototype);return p.createElement=a,p.updateElement=i,p.getHeight=r,p.hitTest=s,p}(),CorporateActionPlotObject.prototype.constructor=CorporateActionPlotObject,DigitalVolatilityPlotObject.prototype=function(){function t(){var t=new fabric.Text("",{stroke:"#ffffff",strokeWidth:1,fontFamily:"Helevetica",fontSize:12,originX:"center",originY:"center"}),e=new fabric.Rect({fill:"#cc6828",width:n,height:n,originX:"center",originY:"center"}),a=new fabric.Group([e,t],{left:0,top:0,width:n,height:n});return a}function e(t){var e=new fabric.Path(t,{fill:"#fff",width:n,height:n,left:-3,top:-3}),a=new fabric.Circle({fill:"#7F7F7F",radius:15}),i=new fabric.Group([a,e],{});return i}function a(){if(!this._element)if(this._data.length>1)this._element=t();else{var a=this._data[0],i="#7F7F7F";this._element=e(a.icon,i)}return this._element}function i(){this._data.length>1&&this._element.item(1).set({text:this._data.length.toString()})}function r(){return n}function s(t,e){if(this._element){var a=this._element.left,i=this._element.top,r=this._element.width,s=this._element.height;return t>=a&&t<=a+r&&e>=i&&e<=i+s?this:void 0}}var n=15,o=Object.create(StackedPlotObject.prototype);return o.createElement=a,o.updateElement=i,o.getHeight=r,o.hitTest=s,o}(),DigitalVolatilityPlotObject.prototype.constructor=DigitalVolatilityPlotObject,StackedPlotObjectSeries.plotObjectsMargin=5,StackedPlotObjectSeries.prototype=function(){function t(t,e){for(var a=t.length,i=a-1;i>=0;i--)if(t[i].getXValue()<=e.getXValue())return i+1;return Math.max(0,i)}function e(t){t.forEachObject(function(e){t.remove(e)})}function a(t,e,a){var i=t.getObjects(),r=0,s=0;i.forEach(function(t){r+=t.height+5,s=Math.max(s,t.width)});var n=a-StackedPlotObjectSeries.plotObjectsMargin/2,o=e-s/2;i.forEach(function(t){n-=t.height,t.top=NumberExtensions.round(n,1),t.left=NumberExtensions.round(o+(s-t.width)/2,1),n-=StackedPlotObjectSeries.plotObjectsMargin})}function i(t,e){for(var a=t.length-1;a>=0;a--){var i=t[a];if(angular.equals(i.getXValue(),e))return i.getYValue()}}function r(t,e,a){for(var i=t.getObjects(),r=0;r<i.length;r++){var s=i[r].stackedPlotObject;if(s&&s===s.hitTest(e,a))return s}}function s(){return this._plotObjects}function n(e){if(!e)throw new UndefinedOrNullException("po");var a=commonsModule.$.isArray(e);if(!(a&&e.length<=0)){for(var i=a?e:[e],r=!1,s=0,n=i.length;s<n;s++){var o=i[s];this._plotObjects.indexOf(o)>=0||(this._plotObjects.splice(t(this._plotObjects,o),0,o),r=!0)}r&&EventBus.trigger(this,"StackedPlotObjectSeries:datachanged")}}function o(t){var e=commonsModule.$.isArray(t);if(!(e&&t.length<=0)){for(var a=e?t:[t],i=!1,r=0,s=a.length;r<s;r++){var n=a[r],o=this._plotObjects.indexOf(n);o<0||(this._plotObjects.splice(o,1),i=!0)}i&&EventBus.trigger(this,"StackedPlotObjectSeries:datachanged")}}function c(t){if(!t)throw new UndefinedOrNullException("series");this._dataSeries=t}function h(){return this._dataSeries}function l(){return ObjectFactory.createInstance(fabric.Group,[])}function u(){var t=this._element;if(e(t),this._dataSeries){var r,s=this._pane.getXAxis(),n=this._pane.getYAxis(),o=this._dataSeries,c=null,h=0;this._plotObjects.forEach(function(e){if(s.isVisible(e.getXValue())){var l=s.toCoordinate(e.getXValue()),u=s.toValue(l);if(!angular.equals(u,r)){r=u,c=ObjectFactory.createInstance(fabric.Group,[]),t.add(c);var d=i(o,u);h=n.toCoordinate(d)}var _=e.createElement();e.updateElement(),_.stackedPlotObject=e,c.add(_),a(c,l,h)}})}}function d(t,e){if(!(!this._element||t<this._element.left||e<this._element.top)){t-=this._element.left,e-=this._element.top;for(var a=this._element.getObjects(),i=0;i<a.length;i++){var s=a[i].left,n=a[i].top,o=t-s,c=e-n,h=r(a[i],o,c);if(h)return h}}}var _=Object.create(PlotObject.prototype);return _.add=n,_.remove=o,_.getPlotObjects=s,_.getDataSeries=h,_.setDataSeries=c,_.createElement=l,_.updateElement=u,_.hitTest=d,_}(),StackedPlotObjectSeries.prototype.constructor=StackedPlotObjectSeries,IndicatorLabel.prototype=function(){function t(){this.value=0;for(var t=this._trackballDataSource.getXValue(),e=this._seriesDataSource.getDataSeries()||[],a=e.length-1;a>=0;a--){var i=e[a];if(angular.equals(i.getXValue(),t))return void(this.value=i.getYValue())}if(e.length>0&&this.showLastValue){var r=e[e.length-1];t>r.getXValue()&&(this.value=r.getYValue())}}function e(){EventBus.trigger(this,"IndicatorLabel:deleted")}function a(){EventBus.trigger(this,"IndicatorLabel:modified")}var i=Object.create(HeaderLabel.prototype);return i.remove=e,i.update=t,i.modify=a,i}(),IndicatorLabel.prototype.constructor=IndicatorLabel,PriceIndicator.prototype=function(){function t(){this.timestamp=void 0,this.open=0,this.close=0,this.high=0,this.low=0}function e(t){this.timestamp=t.timestamp,this.open=t.open,this.close=t.close,this.high=t.high,this.low=t.low}function a(){var a=this._trackballDataSource.getXValue(),i=this._barsDataSource.getBars();t.call(this);var r=this._barsDataSource.getScale();if(this.isIntraday=!!r&&r.isIntraday(),a&&i){for(var s=i.length-1;s>=0;s--){var n=i[s];if(n.timestamp.getTime()===a.getTime())return void e.call(this,n)}this.timestamp=a}}var i=Object.create(HeaderLabel.prototype);return i.update=a,i}(),PriceIndicator.prototype.constructor=PriceIndicator;var Fmr_StockChart_ChartPaneIds={PricePane:"pricePane",VolumePane:"volumePane"};StockChart.trackballTimerPeriod=3e4,StockChart.prototype=function(){function t(t){for(var e=0;e<ot.length;e++){var a=ot[e];if(a.type===t)return a}}function e(t,e){return ObjectFactory.createInstance(OHLCSeries,t,e)}function a(t,e){return ObjectFactory.createInstance(HollowCandlestickSeries,t,e)}function i(t,e){return ObjectFactory.createInstance(FilledCandlestickSeries,t,e)}function r(t,e){return ObjectFactory.createInstance(StandardCandlestickSeries,t,e)}function s(t,e){return ObjectFactory.createInstance(StockLineSeries,t,e)}function n(t,e){var a=ObjectFactory.createInstance(MountainSeries,e._closePriceDataSource,this._mountainColor);return this._mountainLineColor&&a.setLineColor(this._mountainLineColor),a.setFilledWithFixedColor(this._mountainFilledWithFixedColor),a}function o(t,e){var a=t.createPO.call(this,e,this);try{this._pricepane.beginUpdate(),this._pricepane.removePlotObject(this._series),this._series=a,this._pricepane.addPlotObject(a)}finally{this._pricepane.endUpdate()}}function c(){this._securityData=null,this._series&&(this._pricepane.removePlotObject(this._series),this._series=null)}function h(t,e){this._xAxis.setMinMax(t,e)}function l(t,e){this._xAxis.setValues(this._securityData.bars.getTimestamps(),this._securityData.getScale(),this._securityData.getMarketInfo(),t,e)}function u(){if(this._showPreviousClose){var t=this._securityData&&this._securityData.bars;if(t&&t.length){var e=BarsExtensions.previousClose(t,this._securityData.getScale(),this._securityData.getMarketInfo());this._previousCloseLine?this._previousCloseLine.setPrice(e):this._previousCloseLine=ObjectFactory.createInstance(HorizontalLine,e,tinycolor("rgb(255, 0, 0)"),1,1,Fmr_Pwi_Charting_LineStyle.Dotted),this._pricepane.addPlotObject(this._previousCloseLine)}}else this._previousCloseLine&&this._pricepane.removePlotObject(this._previousCloseLine)}function d(){this._showPreviousClose?(this._previousCloseAxisMinMaxSource=ObjectFactory.createInstance(PreviousCloseAxisMinMaxSource,this._barsDataSource),this.getPricePane().getYAxis().getMinMaxManager().register(this._previousCloseAxisMinMaxSource)):(this.getPricePane().getYAxis().getMinMaxManager().unregister(this._previousCloseAxisMinMaxSource),this._previousCloseAxisMinMaxSource.destroy(),this._previousCloseAxisMinMaxSource=null)}function _(){return this._watermark}function g(){0===this._watermarkOpacity?this._pricepane.removePlotObject(this._watermark):(this._watermark.setShowDescription(this._showDescription),this._securityData&&this._watermark.setText(this._securityData.getSymbol(),this._securityData.getDescription()),this._pricepane.addPlotObject(this._watermark))}function p(t){t.length>0?this._trackballDataSource.setXValue(t[t.length-1].timestamp):this._trackballDataSource.setXValue(null)}function f(t,e){e.pane=t,EventBus.trigger(this,"Chart:MouseMove",e)}function S(){var t=this._securityData&&this._securityData.bars;t&&t.length&&this._trackballDataSource.setXValue(t[t.length-1].timestamp)}function x(){clearTimeout(this._trackballTimer),this._trackballTimer=setTimeout(S.bind(this),StockChart.trackballTimerPeriod)}function b(){var t=this._xAxis.getMinValue(),e=this._xAxis.getMaxValue(),a=this._volumeDataSource.getDataSeries();if(!a)return void this._volumepane.getYAxis().setMinMax(0,0);for(var i=0,r=a.length-1;r>=0;r--){var s=a[r],n=s.getXValue();if(n<t)break;if(n<=e){var o=s.getYValue();i<o&&(i=o)}}this._volumepane.getYAxis().setMinMax(0,i)}function v(){this._pricepane=this.createPane(Fmr_StockChart_ChartPaneIds.PricePane),this._pricepane.getYAxisLabels()[0].directiveName="price-pane-y-axis-labels",this._pricepane.setHeight(0);var t=this._pricepane.getYAxis();this._barsAxisMinMaxSource=ObjectFactory.createInstance(BarsAxisMinMaxSource,this._barsDataSource,this._xAxis),this._barsAxisMinMaxSource.setChartType(this._chartType);var e=t.getMinMaxManager();e.register(this._barsAxisMinMaxSource);var a=t.getTickCalculator();a.setMinimumCount&&a.setMinimumCount(5),this._pricepane.addPlotObject(this._watermark),this._pricepane.addPlotObject(this._trackball);var i=ObjectFactory.createInstance(PriceIndicator,"price-indicator",this._trackballDataSource,this._barsDataSource);this._pricepane.addHeaderLabel(i),this._lastTickLabel=y(this),EventBus.on(this._closePriceDataSource,"DataSource:datachanged",function(){this._lastTickLabel.timestamp=void 0;var t=this._closePriceDataSource.getDataSeries();t&&t.length&&(this._lastTickLabel.timestamp=t[t.length-1].getXValue())},this),this._pricepane.addYAxisLabel(this._lastTickLabel),this.addPane(this._pricepane)}function y(t){var e=ObjectFactory.createInstance(LastTickLabel,t._closePriceDataSource,t._xAxis,t.getPricePane().getYAxis(),"y-axis-last-price");return e.textColor="#FFF",e.backgroundColor="#000",e.zIndex=10,e}function m(){if(this._volumepane){b.call(this),this._volumepane.restore();var t=this._volumepane.getYAxis(),e=ObjectFactory.createInstance(YAxisTicksDataSource,t,t.getTicksCalculatorManager()),a=ObjectFactory.createInstance(YAxisLabels,t,e);this._volumepane.addYAxisLabel(a);var i=ObjectFactory.createInstance(HorizontalGridLines,e);this._volumepane.addPlotObject(i);var r=ObjectFactory.createInstance(VerticalGridLines,this._xAxisTicksDataSource,this._showVerticalGridLines);this._volumepane.addPlotObject(r)}else this._volumepane=this.createPane(Fmr_StockChart_ChartPaneIds.VolumePane),EventBus.on(this._volumeDataSource,"DataSource:datachanged",b,this);this._volumeLabel||(this._volumeLabel=ObjectFactory.createInstance(IndicatorLabel,"indicator-label","Vol",this._trackballDataSource,this._volumeDataSource)),this._volumepane.addHeaderLabel(this._volumeLabel),EventBus.on(this._volumeLabel,"IndicatorLabel:deleted",this._volumepane.close,this._volumepane),this._volumeSeries||(this._volumeSeries=ObjectFactory.createInstance(VolumeSeries,this._barsDataSource,this)),this._volumepane.addPlotObject(this._volumeSeries),this._volumeTrackball||(this._volumeTrackball=ObjectFactory.createInstance(Trackball,this._trackballDataSource,this._volumeDataSource)),this._volumepane.addPlotObject(this._volumeTrackball),this.addPane(this._volumepane)}function D(){this._barsDataSource=ObjectFactory.createInstance(BarsDataSource),this._openPriceDataSource=ObjectFactory.createInstance(OpenPriceDataSource,this._barsDataSource),this._highPriceDataSource=ObjectFactory.createInstance(HighPriceDataSource,this._barsDataSource),this._lowPriceDataSource=ObjectFactory.createInstance(LowPriceDataSource,this._barsDataSource),this._closePriceDataSource=ObjectFactory.createInstance(ClosePriceDataSource,this._barsDataSource),this._volumeDataSource=ObjectFactory.createInstance(VolumeDataSource,this._barsDataSource),this._trackballDataSource=ObjectFactory.createInstance(TrackballDataSource),this._xAxisTicksDataSource=ObjectFactory.createInstance(XAxisTicksDataSource,this._xAxis,this._xAxis.getTickCalculator()),this._xAxisDataSource=ObjectFactory.createInstance(StockXAxisDataSource),this._dataSourceCenter=ObjectFactory.createInstance(DataSourceCenter),
this._dataSourceCenter.registerDataSource(this._barsDataSource),this._dataSourceCenter.registerDataSource(this._volumeDataSource),this._dataSourceCenter.registerDataSource(this._openPriceDataSource),this._dataSourceCenter.registerDataSource(this._highPriceDataSource),this._dataSourceCenter.registerDataSource(this._lowPriceDataSource),this._dataSourceCenter.registerDataSource(this._closePriceDataSource),this._dataSourceCenter.registerDataSource(this._trackballDataSource),this._dataSourceCenter.registerDataSource(this._xAxisDataSource)}function C(){this._panes.forEach(function(t){t.refresh()})}function O(t){return t instanceof tinycolor?t:ObjectFactory.createInstance(tinycolor,t)}function P(t){var e=ObjectFactory.createInstance(ChartPane,t),a=ObjectFactory.createInstance(YAxis);e.setYAxis(a),t===Fmr_StockChart_ChartPaneIds.PricePane?e.setXAxis(this._xAxis):e.setXAxis(this._xAxisProxy);var i=a.getTickCalculator(),r=a.getTicksCalculatorManager();r.register(i,0);var s=ObjectFactory.createInstance(YAxisTicksDataSource,a,r),n=ObjectFactory.createInstance(YAxisLabels,a,s);e.addYAxisLabel(n),k.call(this,e);var o=ObjectFactory.createInstance(HorizontalGridLines,s);this._horizontalGridLineColor&&o.setColor(this._horizontalGridLineColor),e.addPlotObject(o);var c=ObjectFactory.createInstance(VerticalGridLines,this._xAxisTicksDataSource,this._showVerticalGridLines);this._verticalGridLineColor&&c.setColor(this._verticalGridLineColor),e.addPlotObject(c);var h=a.getMinMaxManager(),l=ObjectFactory.createInstance(CenterAlignAxisMinMaxSource);h.register(l);var u=ObjectFactory.createInstance(AxisTicksMinMaxSource,s);return h.register(u),e}function k(t){if(this._configuration&&this._configuration.Features.DualAxisCompare){var e=ObjectFactory.createInstance(YAxis);t.setYAxisLeft(e);var a=ObjectFactory.createInstance(YAxisTickSynchronizedCalculator),i=e.getTicksCalculatorManager();i.register(a,0);var r=ObjectFactory.createInstance(YAxisTicksDataSource,e,i,t.getYAxisLabels()[0]._ticksDataSource),s=ObjectFactory.createInstance(YAxisLeftMinMaxManager,e);e._minMaxManager=s;var n=ObjectFactory.createInstance(CenterAlignAxisMinMaxSource);s.register(n);var o=ObjectFactory.createInstance(AxisTicksMinMaxSource,r);s.register(o);var c=ObjectFactory.createInstance(YAxisLabels,e,r);t.addYAxisLeftLabel(c),t.getYAxisLeftLabels()[0].directiveName="price-pane-y-axis-labels"}}function j(){this._upColor=tinycolor("#008000"),this._downColor=tinycolor("#FF0000"),this._chartType=Fmr_StockChart_ChartType.OHLC,this._showPreviousClose=!1,this._securityData,this._previousCloseLine,this._watermarkOpacity=.5,this._showDescription=!0,this._stackedPlotObjectSeries=null,this._xAxis=ObjectFactory.createInstance(XAxis),this._xAxisProxy=ObjectFactory.createInstance(ImmutableXAxisProxy,this._xAxis),D.call(this),this._watermark=ObjectFactory.createInstance(Watermark),this._trackball=ObjectFactory.createInstance(Trackball,this._trackballDataSource,this._closePriceDataSource),this._pricepane=null,this._showVerticalGridLines=ObjectFactory.createInstance(FlagDataSource),v.call(this),this._volumepane=null,this.showVolumePane(!1)}function w(){return this._pricepane}function A(){return this._volumepane}function M(){for(var t=[],e=this.getPanes(),a=e.length,i=0;i<a;i++){var r=e[i];r!==this._pricepane&&r!==this._volumepane&&t.push(r)}return t}function F(e,a,i){var r=new Date(9999,11,31,23,59,59);if(!e)throw new UndefinedOrNullException("securityData");if(a>i)throw new ArgumentException("end","end date must be greater than or equal to start date.");try{this.beginUpdate(),this._errorMessage=null,this._securityData=e;var s=t(this._chartType),n=e.bars;o.call(this,s,n),g.call(this),u.call(this),p.call(this,n),0===n.length?l.call(this,r,r):l.call(this,a,i),this._barsDataSource.setBars(e),this._stackedPlotObjectSeries&&this._stackedPlotObjectSeries.setDataSeries(n.getHighSeries())}finally{this.endUpdate()}}function L(){return this._securityData}function E(t){if(!t)throw new UndefinedOrNullException("errorMessage");this._errorMessage=t,c.call(this)}function B(){return this._errorMessage}function T(t){if(!t)throw new UndefinedOrNullException("calculator");this._xAxis.setTickCalculator(t)}function I(t,e){if(!this._securityData)throw new InvalidOperationException("Security data must be set before setDisplayRange() gets called.");if(!t)throw new UndefinedOrNullException("start");if(!e)throw new UndefinedOrNullException("end");if(t.getTime()>e.getTime())throw new ArgumentException("end","end date must be greater than or equal to start date.");try{this.beginUpdate(),h.call(this,t,e)}finally{this.endUpdate()}}function V(t){this._upColor=O(t),C.call(this)}function H(){return this._upColor}function U(t){this._downColor=O(t),C.call(this)}function Y(){return this._downColor}function X(){return this._chartType}function N(){return this._xAxis}function R(e){if(e<Fmr_StockChart_ChartType.OHLC||e>Fmr_StockChart_ChartType.Mountain)throw new ArgumentOutOfRangeException("chartType");if(this._chartType!==e&&(this._chartType=e,this._barsAxisMinMaxSource.setChartType(e),this._securityData)){var a=t(e);this._previousCloseLine&&this._previousCloseLine.update(),this._trackball.update(),o.call(this,a,this._securityData.bars)}}function G(){return this._showPreviousClose}function W(t){t=!!t,this._showPreviousClose!==t&&(this._showPreviousClose=t,u.call(this),d.call(this))}function z(){return this._watermarkOpacity}function q(t){this._watermarkOpacity=t,g.call(this)}function Z(){return this._showDescription}function $(t){this._showDescription=t,g.call(this)}function J(t){this._showVerticalGridLines.setFlag(t)}function K(){return this._showVerticalGridLines.getFlag()}function Q(t,e){f.call(this,t,e),e&&e.x&&this._trackballDataSource.setXValue(e.x),x.call(this)}function tt(t){var e;t<=this._xAxis.getLength()&&(e=this._xAxis.toValue(t)),f.call(this,void 0,{x:e}),e&&this._trackballDataSource.setXValue(e),x.call(this)}function et(){try{this.beginUpdate(),this._securityData=null,c.call(this),this._previousCloseLine&&this._previousCloseLine.setPrice(void 0),this._watermark.setText("",""),this._trackballDataSource.setXValue(null),this._barsDataSource.setBars(),this._xAxis.setValues([],ObjectFactory.createInstance(BarScale,Fmr_Pwi_Commons_BarScaleType.Daily,0)),this.getPricePane().getYAxis().setMinMax(0,0)}finally{this.endUpdate()}}function at(t){if(!t)throw new UndefinedOrNullException("po");var e=commonsModule.$.isArray(t);if(!(e&&t.length<=0)){if(!this._stackedPlotObjectSeries){this._stackedPlotObjectSeries=ObjectFactory.createInstance(StackedPlotObjectSeries),this._securityData&&this._stackedPlotObjectSeries.setDataSeries(this._securityData.bars.getHighSeries());var a=this._pricepane.getYAxis(),i=ObjectFactory.createInstance(StackedPlotObjectSeriesAxisMinMaxSource,this._stackedPlotObjectSeries,this._xAxis,a);a.getMinMaxManager().register(i)}this._stackedPlotObjectSeries.add(t),this._pricepane.addPlotObject(this._stackedPlotObjectSeries)}}function it(t){if(!t)throw new UndefinedOrNullException("po");var e=commonsModule.$.isArray(t);!this._stackedPlotObjectSeries||e&&t.length<=0||(this._stackedPlotObjectSeries.remove(t),this._stackedPlotObjectSeries.getPlotObjects().length<=0?this._pricepane.removePlotObject(this._stackedPlotObjectSeries):this._pricepane.addPlotObject(this._stackedPlotObjectSeries))}function rt(t){!t||this._volumepane&&this._volumepane.getState()!==Fmr_Pwi_Charting_ChartPaneState.Closed?!t&&this._volumepane&&this._volumepane.getState()!==Fmr_Pwi_Charting_ChartPaneState.Closed&&this._volumepane&&this._volumepane.close():m.call(this)}function st(){return this._dataSourceCenter}function nt(t){this._configuration=t}var ot=[{type:Fmr_StockChart_ChartType.OHLC,proto:OHLCSeries,createPO:e},{type:Fmr_StockChart_ChartType.HollowCandlestick,proto:HollowCandlestickSeries,createPO:a},{type:Fmr_StockChart_ChartType.FilledCandlestick,proto:FilledCandlestickSeries,createPO:i},{type:Fmr_StockChart_ChartType.StandardCandlestick,proto:StandardCandlestickSeries,createPO:r},{type:Fmr_StockChart_ChartType.Line,proto:StockLineSeries,createPO:s},{type:Fmr_StockChart_ChartType.Mountain,proto:MountainSeries,createPO:n}],ct=Object.create(Chart.prototype);return ct.onChartPaneMouseMove=Q,ct.initialize=j,ct.setSecurityData=F,ct.getSecurityData=L,ct.getPricePane=w,ct.getVolumePane=A,ct.getAdditionalPanes=M,ct.getUpColor=H,ct.setUpColor=V,ct.getDownColor=Y,ct.setDownColor=U,ct.getXAxis=N,ct.getChartType=X,ct.setChartType=R,ct.setXAxisTickCalculator=T,ct.setDisplayRange=I,ct.setErrorMessage=E,ct.getErrorMessage=B,ct.setShowPreviousClose=W,ct.getShowPreviousClose=G,ct.getWatermark=_,ct.setWatermarkOpacity=q,ct.getWatermarkOpacity=z,ct.setShowDescription=$,ct.getShowDescription=Z,ct.setShowVerticalGridLines=J,ct.getShowVerticalGridLines=K,ct.onXAxisMouseMove=tt,ct.clear=et,ct.addStackedPlotObjects=at,ct.removeStackedPlotObjects=it,ct.showVolumePane=rt,ct.getDataSourceCenter=st,ct.createPane=P,ct.setConfiguration=nt,ct.setupYAxisLeft=k,ct}(),StockChart.prototype.constructor=StockChart,stockChartModule.directive("stockChart",["getTemplatesBasePath",function(t){return{restrict:"E",scope:{chart:"="},templateUrl:function(e){return t(e)+"stockchart.html"}}}]),CandlestickSeries.prototype=function(){function t(t,e,a,i){var r=ObjectFactory.createInstance(fabric.Path,t,{strokeWidth:1,stroke:e.toRgbString(),left:0,top:0,width:a,height:i});return r.left=0,r.top=0,r}function e(t,e,a,i,r){var s,n,o,c,h=[];s=Math.min(t.y,i.y),o=Math.max(t.y,i.y),n=t.x,c=i.x;var l=r>1;return l?(e.y<s&&(h.push(["M",e.x,e.y]),h.push(["L",e.x,s])),h.push(["M",n,s]),o>s?(h.push(["L",n,o]),h.push(["L",c,o]),h.push(["L",c,s]),h.push(["L",n,s])):h.push(["L",c,s]),a.y>o&&(h.push(["M",a.x,a.y]),h.push(["L",a.x,o]))):h=[["M",e.x,e.y],["L",a.x,a.y],["z"]],h}function a(t,e){for(var a=e.length-1;a>=0;a--)t.unshift(e[a])}function i(t){}function r(){return ObjectFactory.createInstance(fabric.PathGroup,"")}function s(){var i=[],r=[],s=this._element,n=s.paths;n.splice(0,n.length);var o=this._pane,c=this._chart.getChartType(),h=this._bars,l=o.getXAxis(),u=o.getYAxis(),d=l.getBarWidth(),_=l.getLength(),g=u.getLength(),p=d/2-1;p<1?p=1:p>8&&(p=8);for(var f=h.length-1;f>=0;f--){var S=h[f],x=l.toCoordinate(S.timestamp);if(!(x>=_)){if(x<=0)break;var b=BarsExtensions.getBarTrend(h,f,c),v=x+.5,y=u.toCoordinate(S.open),m=u.toCoordinate(S.high),D=u.toCoordinate(S.low),C=u.toCoordinate(S.close),O=new Point(v-p,y),P=new Point(v,m),k=new Point(v,D),j=new Point(v+p,C),w=e(O,P,k,j,d),A=b===Fmr_Pwi_Charting_BarTrend.UP?i:r;a(A,w)}}this._element.paths=[t(i,this._chart.getUpColor(),_,g),t(r,this._chart.getDownColor(),_,g)],this.updateFillColor(this._element.paths)}var n=Object.create(PlotObject.prototype);return n.createElement=r,n.updateFillColor=i,n.updateElement=s,n}(),CandlestickSeries.prototype.constructor=CandlestickSeries,FilledCandlestickSeries.prototype=function(){function t(t){var e=this._chart.getUpColor(),a=this._chart.getDownColor(),i=t[0],r=t[1];i.setFill(e.toRgbString()),r.setFill(a.toRgbString())}var e=Object.create(CandlestickSeries.prototype);return e.updateFillColor=t,e}(),FilledCandlestickSeries.prototype.constructor=FilledCandlestickSeries,StandardCandlestickSeries.prototype=function(){function t(t){var e=this._chart.getDownColor(),a=tinycolor(this._chart.getUpColor().toRgbString());a.setAlpha(0);var i=t[0],r=t[1];i.setFill(a.toRgbString()),r.setFill(e.toRgbString())}var e=Object.create(CandlestickSeries.prototype);return e.updateFillColor=t,e}(),StandardCandlestickSeries.prototype.constructor=StandardCandlestickSeries,HollowCandlestickSeries.prototype=function(){function t(t){var e=t[0],a=t[1],i="#FFF";e.setFill(i),a.setFill(i)}var e=Object.create(CandlestickSeries.prototype);return e.updateFillColor=t,e}(),HollowCandlestickSeries.prototype.constructor=HollowCandlestickSeries,ExtendedHourDatasource.prototype=function(){function t(t,e){var a=e.marketOpen(t).getTime(),i=e.marketClose(t).getTime();return t=t.getTime(),t>=a&&t<=i}function e(){var e=this._xAxis,a=e.getLength(),i=e.getValues(),r=e.getMarketInfo();this._dateRanges=[];var s=ArrayExtensions.quickSearchGreater(i,0,function(t){return e.toCoordinate(t)}),n=ArrayExtensions.quickSearchSmaller(i,a,function(t){return e.toCoordinate(t)});if(s!==-1&&n!==-1)for(var o,c=s;c<=n;c++){var h=i[c];t(h,r)?o=void 0:o?o.max=h:(o=new Range(h,h),this._dateRanges.push(o))}}function a(){var t=this._xAxis,e=t.getBarWidth()/2;this._ranges=this._dateRanges.map(function(a){var i=t.toCoordinate(a.min)-e,r=t.toCoordinate(a.max)+e;return new Range(i,r)})}function i(){this._xAxis.isReady()&&this._xAxis.getScale().isIntraday()&&this._extendedHourFlagDatasource.getValue()?(this._xAxisValues===this._xAxis.getValues()&&this._xAxisMin===this._xAxis.getMinValue()&&this._xAxisMax===this._xAxis.getMaxValue()||e.call(this),a.call(this),this._xAxisValues=this._xAxis.getValues(),this._xAxisMin=this._xAxis.getMinValue(),this._xAxisMax=this._xAxis.getMaxValue(),this._xAxisLength=this._xAxis.getLength()):this._ranges=[],EventBus.trigger(this,"DataSource:datachanged")}function r(){return this._eventRegistered||(this._eventRegistered=!0,EventBus.on(this._xAxis,"Axis:scalechanged",i,this)),this._ranges||i.call(this),this._ranges}function s(){EventBus.off(this._xAxis,"Axis:scalechanged",i,this)}var n=Object.create(DataSource.prototype);return n.getRanges=r,n.destroy=s,n}(),ExtendedHourDatasource.prototype.constructor=ExtendedHourDatasource,ExtendedHourShading.prototype=function(){function t(t){t.forEachObject(function(e){t.remove(e)})}function e(t){for(var e=this._pane.getYAxis().getLength(),a=this._extendedHourDatasource.getRanges(),i=0;i<a.length;i++){var r=a[i],s=r.min,n=r.max,o=n-s,c=ObjectFactory.createInstance(fabric.Rect,{left:s,top:0,width:o,height:e,opacity:this.getOpacity(),fill:this.getColor().toRgbString()});t.add(c)}}function a(){return ObjectFactory.createInstance(fabric.Group)}function i(){var a=this._element;t(a),this._showExtendedHour.getValue()&&e.call(this,a)}function r(){EventBus.off(this._extendedHourDatasource,"DataSource:datachanged",this.update,this),EventBus.off(this._showExtendedHour,"DataSource:datachanged",this.update,this)}var s=Object.create(PlotObject.prototype);return s.createElement=a,s.updateElement=i,s.destroy=r,s}(),ExtendedHourShading.prototype.constructor=ExtendedHourShading,StackedPlotObjectSeriesAxisMinMaxSource.prototype=function(){function t(t,e,a,i){return(e-a)*t/i+e}function e(){var t=this._range;this._range=void 0,i.call(this)&&(a.call(this),r.call(this),s.call(this)),o(t,this._range)&&EventBus.trigger(this,"AxisMinMaxSource:minmaxchanged")}function a(){this._xAxisLength=this._xAxis.getLength(),this._coordinateSeries={},this._groups={}}function i(){var t=this._stackedPlotObjectSeries.getPlotObjects();return!(!t||t.length<1)&&!(!this._xAxis.getLength()||!this._yAxis.getLength()||void 0===this._yAxis.getMinValue()||void 0===this._yAxis.getMaxValue())}function r(){for(var t=this._xAxisLength,e=this._stackedPlotObjectSeries.getDataSeries(),a=e.length-1;a>=0;a--){var i=e[a],r=this._xAxis.toCoordinate(i.getXValue());if(!(r>=t)){if(r<=0)break;var s=i.getYValue();this._coordinateSeries[r]={value:s,y:this._yAxis.toCoordinate(s)}}}}function s(){for(var t,e,a,i,r=this._stackedPlotObjectSeries.getPlotObjects(),s=StackedPlotObjectSeries.plotObjectsMargin/2,o=this._xAxisLength,c=r.length-1;c>=0;c--){var h=r[c],l=this._xAxis.toCoordinate(h.getXValue());if(!(l>=o)){if(l<=0)break;var u=this._coordinateSeries[l];if(void 0!==u){var d=u.value,_=u.y;(void 0===t||d<t)&&(t=d);var g=this._groups[l];g=void 0===g?_-s-h.getHeight():g-h.getHeight()-StackedPlotObjectSeries.plotObjectsMargin,this._groups[l]=g,(void 0===e||g<e)&&(e=g,a=_-g,i=d)}}}n.call(this,t,e,i,a)}function n(e,a,i,r){if(void 0!==e){var s=new Range(e,this._yAxis.toValue(a));if(a<0){var n=this._yAxis.getMinValue(),o=this._yAxis.getLength();s.max=t(r,i,n,o)}this._range=s}}function o(t,e){return!t&&e||t&&!e||t&&e&&(t.min!==e.min||t.max!==e.max)}function c(){return this._eventRegistered||(EventBus.on(this._stackedPlotObjectSeries,"StackedPlotObjectSeries:datachanged",e,this),EventBus.on(this._xAxis,"Axis:scalechanged",e,this),EventBus.on(this._yAxis,"Axis:scalechanged",e,this),e.call(this),this._eventRegistered=!0),this._range}function h(){EventBus.off(this._stackedPlotObjectSeries,"StackedPlotObjectSeries:datachanged",e,this),EventBus.off(this._xAxis,"Axis:scalechanged",e,this),EventBus.off(this._yAxis,"Axis:scalechanged",e,this),AxisMinMaxSource.prototype.destroy.call(this)}var l=Object.create(AxisMinMaxSource.prototype);return l.getMinMax=c,l.destroy=h,l}(),StackedPlotObjectSeriesAxisMinMaxSource.prototype.constructor=StackedPlotObjectSeriesAxisMinMaxSource,SynchronizedClosePriceDataSource.prototype=function(){function t(){var t=this._barsDataSource.getSecurityData(),e=this._baseBarsDataSource.getSecurityData();if(!t||!e)return void(void 0!==this._dataseries&&(this._dataseries=void 0,EventBus.trigger(this,"DataSource:datachanged")));var a=t.getScale(),i=e.getScale();if(a.getScale()===i.getScale()&&a.getInterval()===i.getInterval()){var r=t.bars||ObjectFactory.createInstance(Bars),s=e.bars||ObjectFactory.createInstance(Bars),n=r.getCloseSeries(),o=s.getCloseSeries();this._dataseries=n.synchronize(o),EventBus.trigger(this,"DataSource:datachanged")}}function e(t,e){return!(!t&&!e)&&t!==e}function a(){e(this._lastSecurityData,this._barsDataSource.getSecurityData())&&e(this._lastBaseSecurityData,this._baseBarsDataSource.getSecurityData())?(t.call(this),this._lastSecurityData=this._barsDataSource.getSecurityData(),this._lastBaseSecurityData=this._baseBarsDataSource.getSecurityData()):!e(this._lastSecurityData,this._barsDataSource.getSecurityData())&&e(this._lastBaseSecurityData,this._baseBarsDataSource.getSecurityData())&&void 0!==this._dataseries&&(this._dataseries=void 0,EventBus.trigger(this,"DataSource:datachanged"))}function i(){EventBus.off(this._barsDataSource,"DataSource:datachanged",this.barsUpdated,this),EventBus.off(this._baseBarsDataSource,"DataSource:datachanged",this.barsUpdated,this)}var r=Object.create(DataSeriesDataSource.prototype);return r.barsUpdated=a,r.destroy=i,r}(),SynchronizedClosePriceDataSource.prototype.constructor=SynchronizedClosePriceDataSource;